<div class="container-fluid py-4">
    <%- include("../../partials/filsDArianeUsers.ejs") %>
    <h4 class="mt-5 mb-3 text-primary">Appliquer un filtre</h4>
    <div class="d-flex justify-content-between " >
        <div class="mb-3 d-flex gap-3">
            <!-- Barre de recherche -->
            <form action="/users/etd" method="GET" class="d-flex gap-2">
                <div class="col-md-5">
                    <label class="form-label fw-semibold">Rechercher </label>
                    <input type="text" name="q" class="form-control" placeholder="Rechercher par nom, prénom, email...">
                </div>

                <!-- Filtre par filière -->

                <div class="col-md-4">
                    <label class="form-label fw-semibold">Filiere </label>
                    <select name="filiere" class="form-select">
                        <option value="">Toutes les filières</option>
                        <option value="3ER">3ER</option>
                        <option value="AB">AB</option>
                        <option value="AG">AG</option>
                        <option value="CFA">CFA</option>
                        <option value="GI">GI</option>
                        <option value="HT">HT</option>
                        <option value="MA">MA</option>
                        <option value="MC">MC</option>
                    </select>
                </div>

                <!-- Filtre par promotion -->
                <div class="col-md-3">
                    <label class="form-label fw-semibold">Promo </label>
                    <select name="promotion" class="form-select">
                        <option value="">Toutes les promos</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                        <option value="2027">2027</option>
                    </select>
                </div>
                <div class="col-md-1 d-flex flex-column justify-content-end">
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-search"></i>
                    </button>
                </div>

            </form>
        </div>
        <div class="align-content-center">
             <%- include("../../partials/btnAjout") %>
        </div>
       
    </div>
        
</div>

<div class="">
        <div class="form-section bg-white">
            <div class="form-section-header border-info">
                <h3 class="fw-bold text-primary">
                    <i class="bi bi-people fs-1 me-2"></i>Liste des étudiants
                </h3>
            </div>

            <table class="table table-borderless table-hover table-responsive text-center border-0 shadow p-5">
                <thead class="bg-dark text-white">
                    <tr>
                        <th>Identifiant</th>
                        <th>Prenom et nom</th>
                        <th>Sexe</th>
                        <th>Date de naissance</th>
                        <th>Adresse</th>
                        <th>Téléphone</th>
                        <th>Email</th>
                        <th>Filière</th>
                        <th>Niveau</th>
                        <th>Promotion</th>
                        <th>Matricule</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% etudiants.forEach(etudiant=> { %>
                        <tr>
                            <td>
                                <%= etudiant.identifiant %>
                            </td>
                            <td>
                                <%= etudiant.prenom %>
                                    <%= etudiant.nom %>
                            </td>
                            <td>
                                <%= etudiant.sexe %>
                            </td>
                            <td>
                                <%= etudiant.dateNaissance.toLocaleDateString("fr-FR") %>
                            </td>
                            <td>
                                <%= etudiant.adresse %>
                            </td>
                            <td>
                                <%= etudiant.telephone %>
                            </td>
                            <td>
                                <%= etudiant.email %>
                            </td>
                            <td>
                                <%= etudiant.filiere %>
                            </td>
                            <td>
                                <%= etudiant.niveau %>
                            </td>
                            <td>
                                <%= etudiant.promotion %>
                            </td>
                            <td>
                                <%= etudiant.matricule %>
                            </td>
                            <td>
                                <a href="/users/etd/view/<%= etudiant.identifiant %>"
                                    class="badge bg-primary-subtle text-primary rounded-3 px-1 py-1">
                                    <i class="bi bi-eye fs-4"></i>
                                </a>
                                <a href="/users/etd/edit/<%= etudiant.identifiant %>"
                                    class="badge bg-warning-subtle text-warning rounded-3 px-1 py-1">
                                    <i class="bi bi-pen fs-4"></i>
                                </a>
                                <a action="/demandes/etudiant/delete/<%=etudiant.identifiant %> " method="POST"
                                    class="badge bg-danger-subtle text-danger rounded-3 px-1 py-1">
                                    <button class="bi bi-trash fs-4 text-danger bg-danger-subtle" data-bs-toggle="modal"
                                        data-bs-target="#deleteModal-<%= etudiant.identifiant %>"> </button>

                                    <div class="modal fade" id="deleteModal-<%= etudiant.identifiant %>" tabindex="-1"
                                        aria-hidden="true">
                                        <div class="modal-dialog modal-dialog-centered">
                                            <div class="modal-content">
                                                <div class="modal-header bg-danger text-white">
                                                    <h5 class="modal-title">Confirmation de suppression</h5>
                                                    <button type="button" class="btn-close btn-close-white text-primary"
                                                        data-bs-dismiss="modal"></button>
                                                </div>
                                                <div class="modal-body">
                                                    <p>Voulez-vous vraiment supprimer l'etudiant <strong>
                                                            <%= etudiant.identifiant %>
                                                        </strong> ?</p>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="reset" class="btn btn-primary border-0"
                                                        data-bs-dismiss="modal">Annuler</button>
                                                    <form action="/users/etd/delete/<%= etudiant.identifiant %>"
                                                        method="POST">
                                                        <button type="submit" class="btn btn-danger">Supprimer</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </td>
                        </tr>
                        <% }) %>
                </tbody>
            </table>
        </div>
</div>